.messageContainer {
  display: flex;
  margin-bottom: 20px;
  gap: 12px;
}

.senderContainer {
  flex-direction: row-reverse;
}

.avatarContainer {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

.roleLabel {
  font-size: 12px;
  text-align: center;
  max-width: 80px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.message {
  position: relative;
  max-width: 70%;
  border-radius: 8px;
  overflow: hidden;
}

/* 用户消息气泡 */
.sender {
  border: none;
}

/* IT专家消息气泡 */
.receiver {
  border: none;
}

/* 计算机教授消息气泡 */
.professorMessage {
  border: none;
}

.messageContent {
  font-size: 14px;
  line-height: 1.5;
  transition: background-color 0.3s ease-in-out;
  border-radius: 8px;
  padding: 12px;
  /* 固定最小尺寸以减少布局变化 */
  min-height: 24px;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  
  /* 优化渲染 */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  will-change: contents;
  contain: content;
  content-visibility: auto;
  
  /* 减少重绘 */
  -webkit-font-smoothing: antialiased;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  
  /* 创建层叠上下文，确保渲染隔离 */
  isolation: isolate;
}

/* 防止列表和段落元素导致的布局变动 */
.messageContent p,
.messageContent h1,
.messageContent h2,
.messageContent h3,
.messageContent h4,
.messageContent h5,
.messageContent h6,
.messageContent ul,
.messageContent ol,
.messageContent li,
.messageContent pre,
.messageContent blockquote {
  /* 使这些元素的变化不影响其他元素布局 */
  contain: content;
  margin-bottom: 0.5em;
  transform: translateZ(0);
}

/* 防止从外部继承的动画干扰内容稳定性 */
.stableContent > div,
.stableContent > p,
.stableContent > span {
  animation: none !important;
  transition: none !important;
  will-change: auto;
}

/* 用户消息内容 - 背景色由JS动态设置 */
.sender .messageContent {
  /* 背景色通过内联样式动态设置 */
}

/* IT专家消息内容 - 背景色由JS动态设置 */
.receiver .messageContent {
  /* 背景色通过内联样式动态设置 */
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

/* 移除固定的文本颜色样式 */
.receiver .messageContent p,
.receiver .messageContent li,
.receiver .messageContent h1,
.receiver .messageContent h2,
.receiver .messageContent h3,
.receiver .messageContent h4,
.receiver .messageContent h5,
.receiver .messageContent h6,
.receiver .messageContent span,
.receiver .messageContent code,
.receiver .messageContent pre {
  /* 文本颜色由JS动态设置 */
  transition: color 0.2s ease-in-out;
}

/* 计算机教授消息内容 - 背景色由JS动态设置 */
.professorMessage .messageContent {
  /* 背景色通过内联样式动态设置 */
}

/* 段落样式 */
.paragraph {
  margin: 0.5em 0;
  white-space: pre-wrap;
}

/* 标题样式 */
.heading {
  margin: 1em 0 0.5em !important;
  font-weight: 600 !important;
}

/* 列表样式 */
.list {
  margin: 0.5em 0;
  padding-left: 1.5em;
}

.listItem {
  margin: 0.3em 0;
}

/* 代码样式 */
.code {
  background-color: rgba(0, 0, 0, 0.06);
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-family: monospace;
  font-size: 0.9em;
}

/* 代码块样式 */
.pre {
  background-color: rgba(0, 0, 0, 0.06);
  padding: 1em;
  border-radius: 5px;
  overflow-x: auto;
  margin: 0.5em 0;
}

.pre code {
  background-color: transparent;
  padding: 0;
}

/* 引用样式 */
.blockquote {
  border-left: 4px solid rgba(0, 0, 0, 0.1);
  margin: 0.5em 0;
  padding-left: 1em;
  /* 颜色由JS动态设置 */
}

/* 发送者消息的特殊样式 */
.sender .code,
.sender .pre {
  background-color: rgba(255, 255, 255, 0.2);
}

.sender .blockquote {
  border-left-color: rgba(255, 255, 255, 0.3);
  /* 颜色由JS动态设置 */
}

.typingIndicator {
  display: flex;
  gap: 4px;
  margin-top: 8px;
}

.dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  animation: bounce 1.4s infinite ease-in-out;
  /* 背景色通过内联样式动态设置 */
}

.dot:nth-child(1) { animation-delay: -0.32s; }
.dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes bounce {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1); }
}

/* 保留教授消息的其他特性 */
.professorMessage .heading {
  /* 使用当前主题色由JS控制 */
}

.professorMessage blockquote {
  border-left-color: transparent;
  background-color: rgba(0, 0, 0, 0.03);
}

/* 响应式调整 */
@media (max-width: 768px) {
  /* 移除对after伪元素的样式调整 */
}

@media (max-width: 480px) {
  /* 移除对after伪元素的样式调整 */
}

/* 稳定内容样式，减少重绘 */
.stableContent {
  /* 更简单的渲染优化方案 */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  
  /* 确保平滑过渡 */
  opacity: 1;
  transition: opacity 0.05s ease-in-out;
  
  /* 优化文本渲染 */
  text-rendering: optimizeSpeed;
  -webkit-font-smoothing: antialiased;
  
  /* 硬件加速渲染 */
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  
  /* 阻止子元素导致的重排 */
  contain: content;
}

/* 非稳定状态下的内容 */
.unstableContent {
  opacity: 0.95;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  transition: none;
  will-change: contents;
} 